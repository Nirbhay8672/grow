import{d as D,h as g,x as q,z as $,A as L,c as r,a as e,w as v,b as m,e as _,n as b,t as n,v as V,F as x,r as C,f as F,p,o as d,g as z,i as j,j as k,u as P,k as Y,l as G,m as M,q as U}from"./app-CtIQcBuM.js";import{_ as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-BJZPRBDV.js";import{d as J}from"./index-BcgMG_W3.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CMWG4mbA.js";const O={class:"space-y-4"},Q={class:"row"},R={class:"col-md-6 mb-3"},W={class:"form-group"},X={key:0,class:"invalid-feedback"},Z={class:"col-md-6 mb-3"},I={class:"form-group"},ee={key:0,class:"invalid-feedback"},te={class:"col-md-6 mb-3"},se={class:"form-group"},ae={key:0,class:"invalid-feedback"},le={class:"col-md-6 mb-3"},ie={class:"form-group"},oe={key:0,class:"invalid-feedback"},ne={class:"col-md-6 mb-3"},re={class:"form-group"},de={key:0,class:"invalid-feedback"},ce={class:"col-md-6 mb-3"},me={class:"form-group"},ue={key:0,class:"invalid-feedback"},fe={class:"col-md-6 mb-3"},be={class:"form-group"},ve={key:0,class:"invalid-feedback"},he={class:"col-md-6 mb-3"},ye={class:"form-group"},_e={key:0,class:"invalid-feedback"},ge={class:"col-md-6 mb-3"},pe={class:"form-group"},we={key:0,class:"invalid-feedback"},ke={class:"col-md-6 mb-3"},xe={class:"form-group"},$e=["placeholder","required"],Ue={key:0,class:"invalid-feedback"},Ce={class:"col-md-6 mb-3"},De={class:"form-group"},Ee=["value"],Ve={key:0,class:"invalid-feedback"},Me={class:"col-md-6 mb-3"},Ae={class:"form-group"},Be=["disabled"],Ne=["value"],Te={key:0,class:"form-text"},Se={key:1,class:"invalid-feedback"},qe={class:"col-md-6 mb-3"},Le={class:"form-group"},Fe={class:"form-check mt-2"},ze=D({__name:"UserForm",props:{form:{},states:{},editingUser:{},errors:{}},emits:["submit","cancel"],setup(s,{emit:w}){const c=s,u=g([]),h=g(!1),f=q({get:()=>c.form.birth_date?typeof c.form.birth_date=="string"&&c.form.birth_date.match(/^\d{4}-\d{2}-\d{2}$/)?c.form.birth_date:typeof c.form.birth_date=="string"?c.form.birth_date.split("T")[0]:"":"",set:a=>{c.form.birth_date=a}}),i=async a=>{if(a){h.value=!0;try{const t=await p.get(`/states/${a}/cities`);u.value=t.data}catch(t){console.error("Error loading cities:",t),u.value=[]}finally{h.value=!1}}};return $(()=>c.editingUser,async a=>{a&&a.state_id&&await i(a.state_id)},{immediate:!0}),$([u,()=>c.editingUser],async([a,t])=>{a.length>0&&t&&t.city_id&&!c.form.city_id&&(await L(),c.form.city_id=t.city_id)},{immediate:!0}),$(()=>c.form.state_id,async(a,t)=>{a?a!==t&&t!==void 0&&t!==null&&t!==""?(await i(a),c.form.city_id=""):u.value.length||await i(a):(u.value=[],c.form.city_id="")},{immediate:!0}),(a,t)=>(d(),r("div",O,[e("div",Q,[e("div",R,[e("div",W,[t[15]||(t[15]=e("label",{for:"name",class:"form-label"},"Full Name",-1)),v(e("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=l=>s.form.name=l),type:"text",class:b(["form-control",{"is-invalid":s.errors.name}]),placeholder:"Enter full name",required:""},null,2),[[_,s.form.name]]),s.errors.name?(d(),r("div",X,n(s.errors.name[0]),1)):m("",!0)])]),e("div",Z,[e("div",I,[t[16]||(t[16]=e("label",{for:"username",class:"form-label"},"Username",-1)),v(e("input",{id:"username","onUpdate:modelValue":t[1]||(t[1]=l=>s.form.username=l),type:"text",class:b(["form-control",{"is-invalid":s.errors.username}]),placeholder:"Enter username",required:""},null,2),[[_,s.form.username]]),s.errors.username?(d(),r("div",ee,n(s.errors.username[0]),1)):m("",!0)])]),e("div",te,[e("div",se,[t[17]||(t[17]=e("label",{for:"first_name",class:"form-label"},"First Name",-1)),v(e("input",{id:"first_name","onUpdate:modelValue":t[2]||(t[2]=l=>s.form.first_name=l),type:"text",class:b(["form-control",{"is-invalid":s.errors.first_name}]),placeholder:"Enter first name",required:""},null,2),[[_,s.form.first_name]]),s.errors.first_name?(d(),r("div",ae,n(s.errors.first_name[0]),1)):m("",!0)])]),e("div",le,[e("div",ie,[t[18]||(t[18]=e("label",{for:"last_name",class:"form-label"},"Last Name",-1)),v(e("input",{id:"last_name","onUpdate:modelValue":t[3]||(t[3]=l=>s.form.last_name=l),type:"text",class:b(["form-control",{"is-invalid":s.errors.last_name}]),placeholder:"Enter last name",required:""},null,2),[[_,s.form.last_name]]),s.errors.last_name?(d(),r("div",oe,n(s.errors.last_name[0]),1)):m("",!0)])]),e("div",ne,[e("div",re,[t[19]||(t[19]=e("label",{for:"middle_name",class:"form-label"},"Middle Name",-1)),v(e("input",{id:"middle_name","onUpdate:modelValue":t[4]||(t[4]=l=>s.form.middle_name=l),type:"text",class:b(["form-control",{"is-invalid":s.errors.middle_name}]),placeholder:"Enter middle name (optional)"},null,2),[[_,s.form.middle_name]]),s.errors.middle_name?(d(),r("div",de,n(s.errors.middle_name[0]),1)):m("",!0)])]),e("div",ce,[e("div",me,[t[20]||(t[20]=e("label",{for:"email",class:"form-label"},"Email",-1)),v(e("input",{id:"email","onUpdate:modelValue":t[5]||(t[5]=l=>s.form.email=l),type:"email",class:b(["form-control",{"is-invalid":s.errors.email}]),placeholder:"Enter email",onInput:t[6]||(t[6]=l=>s.form.email=l.target.value.toLowerCase()),required:""},null,34),[[_,s.form.email]]),s.errors.email?(d(),r("div",ue,n(s.errors.email[0]),1)):m("",!0)])]),e("div",fe,[e("div",be,[t[21]||(t[21]=e("label",{for:"mobile",class:"form-label"},"Mobile",-1)),v(e("input",{id:"mobile","onUpdate:modelValue":t[7]||(t[7]=l=>s.form.mobile=l),type:"text",class:b(["form-control",{"is-invalid":s.errors.mobile}]),placeholder:"Enter mobile number (optional)"},null,2),[[_,s.form.mobile]]),s.errors.mobile?(d(),r("div",ve,n(s.errors.mobile[0]),1)):m("",!0)])]),e("div",he,[e("div",ye,[t[22]||(t[22]=e("label",{for:"company_name",class:"form-label"},"Company Name",-1)),v(e("input",{id:"company_name","onUpdate:modelValue":t[8]||(t[8]=l=>s.form.company_name=l),type:"text",class:b(["form-control",{"is-invalid":s.errors.company_name}]),placeholder:"Enter company name (optional)"},null,2),[[_,s.form.company_name]]),s.errors.company_name?(d(),r("div",_e,n(s.errors.company_name[0]),1)):m("",!0)])]),e("div",ge,[e("div",pe,[t[23]||(t[23]=e("label",{for:"birth_date",class:"form-label"},"Birth Date",-1)),v(e("input",{id:"birth_date","onUpdate:modelValue":t[9]||(t[9]=l=>f.value=l),type:"date",class:b(["form-control",{"is-invalid":s.errors.birth_date}])},null,2),[[_,f.value]]),s.errors.birth_date?(d(),r("div",we,n(s.errors.birth_date[0]),1)):m("",!0)])]),e("div",ke,[e("div",xe,[t[24]||(t[24]=e("label",{for:"password",class:"form-label"}," Password ",-1)),v(e("input",{id:"password","onUpdate:modelValue":t[10]||(t[10]=l=>s.form.password=l),type:"password",class:b(["form-control",{"is-invalid":s.errors.password}]),placeholder:s.editingUser?"Enter new password (optional)":"Enter password",required:!s.editingUser},null,10,$e),[[_,s.form.password]]),s.errors.password?(d(),r("div",Ue,n(s.errors.password[0]),1)):m("",!0)])]),e("div",Ce,[e("div",De,[t[26]||(t[26]=e("label",{for:"state_id",class:"form-label"},"State",-1)),v(e("select",{id:"state_id","onUpdate:modelValue":t[11]||(t[11]=l=>s.form.state_id=l),class:b(["form-control",{"is-invalid":s.errors.state_id}]),onChange:t[12]||(t[12]=l=>s.form.city_id="")},[t[25]||(t[25]=e("option",{value:""},"Select a state",-1)),(d(!0),r(x,null,C(s.states,l=>(d(),r("option",{key:l.id,value:l.id},n(l.name)+" ("+n(l.code)+") ",9,Ee))),128))],34),[[V,s.form.state_id]]),s.errors.state_id?(d(),r("div",Ve,n(s.errors.state_id[0]),1)):m("",!0)])]),e("div",Me,[e("div",Ae,[t[28]||(t[28]=e("label",{for:"city_id",class:"form-label"},"City",-1)),v(e("select",{id:"city_id","onUpdate:modelValue":t[13]||(t[13]=l=>s.form.city_id=l),class:b(["form-control",{"is-invalid":s.errors.city_id}]),disabled:!s.form.state_id||h.value},[t[27]||(t[27]=e("option",{value:""},"Select a city",-1)),(d(!0),r(x,null,C(u.value,l=>(d(),r("option",{key:l.id,value:l.id},n(l.name),9,Ne))),128))],10,Be),[[V,s.form.city_id]]),h.value?(d(),r("div",Te,"Loading cities...")):m("",!0),s.errors.city_id?(d(),r("div",Se,n(s.errors.city_id[0]),1)):m("",!0)])]),e("div",qe,[e("div",Le,[t[30]||(t[30]=e("label",{class:"form-label"},"Status",-1)),e("div",Fe,[v(e("input",{id:"is_active","onUpdate:modelValue":t[14]||(t[14]=l=>s.form.is_active=l),type:"checkbox",class:"form-check-input"},null,512),[[F,s.form.is_active]]),t[29]||(t[29]=e("label",{for:"is_active",class:"form-check-label"}," Active ",-1))])])])])]))}}),je={class:"card"},Pe={class:"card-body p-0"},Ye={class:"table4 p-25 bg-white mb-30"},Ge={class:"table-responsive"},He={class:"table mb-0"},Je={class:"userDatatable-content"},Ke={class:"d-flex align-items-center"},Oe={class:"userDatatable-inline-title"},Qe={href:"#",class:"text-dark fw-500"},Re={class:"d-block mb-0"},We={class:"text-muted"},Xe={class:"userDatatable-content"},Ze={class:"userDatatable-content"},Ie={class:"userDatatable-content"},et={key:0,class:"text-muted"},tt={key:1,class:"text-muted"},st={class:"userDatatable-content"},at={class:"userDatatable-content"},lt={class:"form-check form-switch"},it=["checked","onChange","id"],ot=["for"],nt={class:"userDatatable-content"},rt={class:"userDatatable-content"},dt={class:"d-flex align-items-center gap-2"},ct=["onClick"],mt=["onClick"],ut={key:0,class:"text-center py-5"},ft=D({__name:"UserTable",props:{users:{}},emits:["edit","delete","toggle-active"],setup(s,{emit:w}){const c=w,u=h=>new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return z(()=>{typeof window<"u"&&window.feather&&window.feather.replace()}),(h,f)=>(d(),r("div",je,[f[2]||(f[2]=e("div",{class:"card-header color-dark fw-500"}," Users Management ",-1)),e("div",Pe,[e("div",Ye,[e("div",Ge,[e("table",He,[f[0]||(f[0]=e("thead",null,[e("tr",{class:"userDatatable-header"},[e("th",null,[e("span",{class:"userDatatable-title"},"Name")]),e("th",null,[e("span",{class:"userDatatable-title"},"Username")]),e("th",null,[e("span",{class:"userDatatable-title"},"Email")]),e("th",null,[e("span",{class:"userDatatable-title"},"Location")]),e("th",null,[e("span",{class:"userDatatable-title"},"Mobile")]),e("th",null,[e("span",{class:"userDatatable-title"},"Status")]),e("th",null,[e("span",{class:"userDatatable-title"},"Created")]),e("th",null,[e("span",{class:"userDatatable-title"},"Actions")])])],-1)),e("tbody",null,[(d(!0),r(x,null,C(s.users,i=>(d(),r("tr",{key:i.id},[e("td",null,[e("div",Je,[e("div",Ke,[e("div",Oe,[e("a",Qe,n(i.name),1),e("p",Re,[e("span",We,n(i.first_name)+" "+n(i.middle_name||"")+" "+n(i.last_name),1)])])])])]),e("td",null,[e("div",Xe,n(i.username),1)]),e("td",null,[e("div",Ze,n(i.email),1)]),e("td",null,[e("div",Ie,[i.city&&i.state?(d(),r("span",et,n(i.city.name)+", "+n(i.state.name),1)):(d(),r("span",tt,"-"))])]),e("td",null,[e("div",st,n(i.mobile||"-"),1)]),e("td",null,[e("div",at,[e("div",lt,[e("input",{class:"form-check-input",type:"checkbox",checked:i.is_active,onChange:a=>c("toggle-active",i),role:"switch",id:`status-${i.id}`},null,40,it),e("label",{class:"form-check-label",for:`status-${i.id}`},[e("span",{class:b(["rounded-pill userDatatable-content-status ms-2",i.is_active?"bg-opacity-success color-success active":"bg-opacity-danger color-danger"])},n(i.is_active?"Active":"Inactive"),3)],8,ot)])])]),e("td",null,[e("div",nt,n(u(i.created_at)),1)]),e("td",null,[e("div",rt,[e("div",dt,[e("button",{onClick:a=>c("edit",i),class:"btn btn-sm btn-outline-primary",title:"Edit User",style:{padding:"4px 8px","min-width":"32px",height:"32px"}}," ✏️ ",8,ct),e("button",{onClick:a=>c("delete",i),class:"btn btn-sm btn-outline-danger",title:"Delete User",style:{padding:"4px 8px","min-width":"32px",height:"32px"}}," 🗑️ ",8,mt)])])])]))),128))])])])])]),s.users.length===0?(d(),r("div",ut,[...f[1]||(f[1]=[e("div",{class:"mb-3"},[e("span",{style:{"font-size":"48px"}},"👥")],-1),e("h6",{class:"text-muted"},"No users found",-1),e("p",{class:"text-muted mb-0"},"Get started by creating a new user.",-1)])])):m("",!0)]))}}),bt={class:"row"},vt={class:"col-12"},ht={key:0,class:"modal fade show d-block",tabindex:"-1",role:"dialog","aria-labelledby":"userModalLabel","aria-hidden":"false",style:{"background-color":"rgba(0,0,0,0.5)"}},yt={class:"modal-dialog modal-lg modal-dialog-centered",role:"document"},_t={class:"modal-content"},gt={class:"modal-header"},pt={class:"modal-title",id:"userModalLabel"},wt={class:"modal-body"},kt={class:"modal-footer"},xt=["disabled"],$t={key:0,class:"spinner-border spinner-border-sm me-1"},Ut={class:"d-flex align-items-center"},Ct={class:"me-2",style:{"font-size":"18px"}},Dt=D({__name:"Users",props:{users:{},states:{}},setup(s){const w=[{title:"Dashboard",href:J().url},{title:"Users",href:"/users"}],c=g(!1),u=g(null),h=g(!1),f=g({}),i=g({show:!1,message:"",type:"success"}),a=j({name:"",username:"",first_name:"",middle_name:"",last_name:"",mobile:"",email:"",company_name:"",birth_date:"",state_id:"",city_id:"",is_active:!0,password:""}),t=()=>{a.name="",a.username="",a.first_name="",a.middle_name="",a.last_name="",a.mobile="",a.email="",a.company_name="",a.birth_date="",a.state_id="",a.city_id="",a.is_active=!0,a.password="",f.value={},u.value=null,c.value=!1},l=(o,y="success")=>{i.value={show:!0,message:o,type:y},setTimeout(()=>{i.value.show=!1},3e3)},A=o=>{u.value=o,a.name=o.name,a.username=o.username,a.first_name=o.first_name,a.middle_name=o.middle_name||"",a.last_name=o.last_name,a.mobile=o.mobile||"",a.email=o.email,a.company_name=o.company_name||"",a.birth_date=o.birth_date||"",a.state_id=o.state_id?.toString()||"",a.city_id=o.city_id?.toString()||"",a.is_active=o.is_active,a.password="",f.value={},c.value=!0},B=()=>{t(),c.value=!0},E=async()=>{h.value=!0,f.value={};try{const o={...a,state_id:a.state_id?parseInt(a.state_id):null,city_id:a.city_id?parseInt(a.city_id):null};u.value?(o.password||delete o.password,await p.put(`/users/${u.value.id}`,o),l("User updated successfully!")):(await p.post("/users",o),l("User created successfully!")),t(),U.reload()}catch(o){o.response?.status===422?(f.value=o.response.data.errors,l("Please fix the validation errors.","error")):(console.error("Error saving user:",o),l("An error occurred while saving the user.","error"))}finally{h.value=!1}},N=async o=>{if((await window.Swal.fire({title:"Are you sure?",text:`You are about to delete the user "${o.name}". This action cannot be undone!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{await p.delete(`/users/${o.id}`),l("User deleted successfully!"),U.reload()}catch(S){console.error("Error deleting user:",S),l("An error occurred while deleting the user.","error")}},T=async o=>{try{await p.patch(`/users/${o.id}/toggle-active`),l(`User ${o.is_active?"deactivated":"activated"} successfully!`),U.reload()}catch(y){console.error("Error toggling user status:",y),l("An error occurred while updating user status.","error")}};return(o,y)=>(d(),r(x,null,[k(P(Y),{title:"Users Management"}),k(H,{breadcrumbs:w},{default:G(()=>[e("div",bt,[e("div",vt,[e("div",{class:"d-flex justify-content-between align-items-center mb-30 mt-4"},[y[1]||(y[1]=e("div",null,[e("h4",{class:"color-dark fw-500"},"Users Management"),e("p",{class:"text-muted mb-0"},"Manage users and their information")],-1)),e("button",{onClick:B,class:"btn btn-primary btn-default btn-squared text-capitalize lh-normal px-50 py-15"},[...y[0]||(y[0]=[e("span",{"data-feather":"plus",class:"me-1"},null,-1),M(" Add User ",-1)])])]),k(ft,{users:s.users,onEdit:A,onDelete:N,onToggleActive:T},null,8,["users"]),c.value?(d(),r("div",ht,[e("div",yt,[e("div",_t,[e("div",gt,[e("h5",pt,n(u.value?"Edit User":"Create User"),1),e("button",{type:"button",class:"btn-close",onClick:t,"aria-label":"Close"},[...y[2]||(y[2]=[e("span",{"aria-hidden":"true"},"×",-1)])])]),e("div",wt,[k(ze,{form:a,states:s.states,"editing-user":u.value,errors:f.value,onSubmit:E,onCancel:t},null,8,["form","states","editing-user","errors"])]),e("div",kt,[e("button",{type:"button",class:"btn btn-secondary",onClick:t}," Cancel "),e("button",{type:"button",class:"btn btn-primary",onClick:E,disabled:h.value},[h.value?(d(),r("span",$t)):m("",!0),M(" "+n(u.value?"Update User":"Create User"),1)],8,xt)])])])])):m("",!0)])]),i.value.show?(d(),r("div",{key:0,class:b(["toast-notification",i.value.type==="success"?"toast-success":"toast-error"]),style:{position:"fixed",top:"20px",right:"20px","z-index":"9999","min-width":"300px",padding:"12px 16px","border-radius":"8px",color:"white","font-weight":"500","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"}},[e("div",Ut,[e("span",Ct,n(i.value.type==="success"?"✅":"❌"),1),e("span",null,n(i.value.message),1)])],2)):m("",!0)]),_:1})],64))}}),Tt=K(Dt,[["__scopeId","data-v-59756ac3"]]);export{Tt as default};
