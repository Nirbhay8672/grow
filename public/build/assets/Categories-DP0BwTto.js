import{d as S,r as l,f as $,c as _,a as c,u as z,h as A,w as p,b as s,i as E,A as k,e as v,m as F,t as h,F as N,s as f,x as C,_ as V}from"./app-CvLl_M2Q.js";import{_ as D}from"./AppLayout.vue_vue_type_script_setup_true_lang-BxU0oBNB.js";import{M}from"./Modal-DIhtmqai.js";import{_ as Y}from"./CategoryForm.vue_vue_type_script_setup_true_lang-DNaVBaA4.js";import{_ as q}from"./CategoryTable.vue_vue_type_script_setup_true_lang-D6KJu-o9.js";import{d as I}from"./index-BcgMG_W3.js";import"./index-CMWG4mbA.js";const P={class:"row"},U={class:"col-12"},j={class:"d-flex align-items-center"},G={class:"me-2",style:{"font-size":"18px"}},H=S({__name:"Categories",props:{categories:{},constructionTypes:{}},setup(g){const w=[{title:"Dashboard",href:I().url},{title:"Categories",href:"/categories"}],u=l(!1),a=l(null),m=l(!1),n=l({}),o=l({show:!1,message:"",type:"success"}),t=$({name:"",construction_type_id:null,is_active:!0}),d=()=>{t.name="",t.construction_type_id=null,t.is_active=!0,n.value={},a.value=null,u.value=!1},r=(e,i="success")=>{o.value={show:!0,message:e,type:i},setTimeout(()=>{o.value.show=!1},3e3)},x=e=>{a.value=e,t.name=e.name,t.construction_type_id=e.construction_type_id,t.is_active=e.is_active,n.value={},u.value=!0},b=()=>{d(),u.value=!0},y=async()=>{m.value=!0,n.value={};try{a.value?(await f.put(`/categories/${a.value.id}`,t),r("Category updated successfully!")):(await f.post("/categories",t),r("Category created successfully!")),d(),C.reload()}catch(e){e.response?.status===422?(n.value=e.response.data.errors,r("Please fix the validation errors.","error")):(console.error("Error saving category:",e),r("An error occurred while saving the category.","error"))}finally{m.value=!1}},B=async e=>{if((await window.Swal.fire({title:"Are you sure?",text:`You are about to delete the category "${e.name}". This action cannot be undone!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{await f.delete(`/categories/${e.id}`),r("Category deleted successfully!"),C.reload()}catch(T){console.error("Error deleting category:",T),r("An error occurred while deleting the category.","error")}};return(e,i)=>(v(),_(N,null,[c(z(A),{title:"Categories Management"}),c(D,{breadcrumbs:w},{default:p(()=>[s("div",P,[s("div",U,[c(q,{categories:g.categories,onEdit:x,onDelete:B},{"header-action":p(()=>[s("button",{onClick:b,class:"btn btn-primary btn-sm btn-default btn-squared text-capitalize lh-normal px-3 py-2"},[...i[0]||(i[0]=[s("span",{"data-feather":"plus",class:"me-1"},null,-1),k(" Add Category ",-1)])])]),_:1},8,["categories"]),c(M,{show:u.value,title:a.value?"Edit Category":"Create Category",loading:m.value,"submit-label":a.value?"Update Category":"Create Category",size:"sm",onClose:d,onSubmit:y},{default:p(()=>[c(Y,{form:t,"editing-category":a.value,errors:n.value,"construction-types":g.constructionTypes,onSubmit:y,onCancel:d},null,8,["form","editing-category","errors","construction-types"])]),_:1},8,["show","title","loading","submit-label"])])]),o.value.show?(v(),_("div",{key:0,class:F(["toast-notification",o.value.type==="success"?"toast-success":"toast-error"]),style:{position:"fixed",top:"20px",right:"20px","z-index":"9999","min-width":"300px",padding:"12px 16px","border-radius":"8px",color:"white","font-weight":"500","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"}},[s("div",j,[s("span",G,h(o.value.type==="success"?"✅":"❌"),1),s("span",null,h(o.value.message),1)])],2)):E("",!0)]),_:1})],64))}}),Z=V(H,[["__scopeId","data-v-13db40f6"]]);export{Z as default};
