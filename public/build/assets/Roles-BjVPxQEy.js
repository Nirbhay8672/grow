import{d as S,f as d,r as T,c as m,a as p,u as $,h as E,w as x,b as e,i as b,q as w,e as f,t as h,n as A,F,s as _,I as g,_ as N}from"./app-0JMNLgL9.js";import{_ as V}from"./AppLayout.vue_vue_type_script_setup_true_lang-B_cPmPuj.js";import{_ as D}from"./RoleForm.vue_vue_type_script_setup_true_lang-TAySuH6g.js";import{_ as M}from"./RoleTable.vue_vue_type_script_setup_true_lang-BCLnE51e.js";import{d as q}from"./index-BcgMG_W3.js";import"./index-CMWG4mbA.js";const I={class:"row"},L={class:"col-12"},Y={key:0,class:"modal fade show d-block",tabindex:"-1",role:"dialog","aria-labelledby":"roleModalLabel","aria-hidden":"false",style:{"background-color":"rgba(0,0,0,0.5)"}},P={class:"modal-dialog modal-lg modal-dialog-centered",role:"document"},U={class:"modal-content"},j={class:"modal-header py-2 px-3"},G={class:"modal-title mb-0",id:"roleModalLabel",style:{"font-size":"16px","font-weight":"600"}},H={class:"modal-body py-3 px-3"},J={class:"modal-footer py-2 px-3"},K=["disabled"],O={key:0,class:"spinner-border spinner-border-sm me-1"},Q={class:"d-flex align-items-center"},W={class:"me-2",style:{"font-size":"18px"}},X=S({__name:"Roles",props:{roles:{},permissions:{}},setup(v){const C=[{title:"Dashboard",href:q().url},{title:"Roles",href:"/roles"}],c=d(!1),t=d(null),u=d(!1),n=d({}),l=d({show:!1,message:"",type:"success"}),a=T({name:"",permissions:[]}),i=()=>{a.name="",a.permissions=[],n.value={},t.value=null,c.value=!1},r=(s,o="success")=>{l.value={show:!0,message:s,type:o},setTimeout(()=>{l.value.show=!1},3e3)},R=s=>{t.value=s,a.name=s.name,a.permissions=s.permissions.map(o=>o.name),n.value={},c.value=!0},k=()=>{i(),c.value=!0},y=async()=>{u.value=!0,n.value={};try{t.value?(await _.put(`/roles/${t.value.id}`,a),r("Role updated successfully!")):(await _.post("/roles",a),r("Role created successfully!")),i(),g.reload()}catch(s){s.response?.status===422?(n.value=s.response.data.errors,r("Please fix the validation errors.","error")):(console.error("Error saving role:",s),r("An error occurred while saving the role.","error"))}finally{u.value=!1}},B=async s=>{if((await window.Swal.fire({title:"Are you sure?",text:`You are about to delete the role "${s.name}". This action cannot be undone!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{await _.delete(`/roles/${s.id}`),r("Role deleted successfully!"),g.reload()}catch(z){console.error("Error deleting role:",z),r("An error occurred while deleting the role.","error")}};return(s,o)=>(f(),m(F,null,[p($(E),{title:"Roles Management"}),p(V,{breadcrumbs:C},{default:x(()=>[e("div",I,[e("div",L,[p(M,{roles:v.roles,onEdit:R,onDelete:B},{"header-action":x(()=>[e("button",{onClick:k,class:"btn btn-primary btn-sm btn-default btn-squared text-capitalize lh-normal px-3 py-2"},[...o[0]||(o[0]=[e("span",{"data-feather":"plus",class:"me-1"},null,-1),w(" Add Role ",-1)])])]),_:1},8,["roles"]),c.value?(f(),m("div",Y,[e("div",P,[e("div",U,[e("div",j,[e("h5",G,h(t.value?"Edit Role":"Create Role"),1),e("button",{type:"button",class:"btn-close",onClick:i,"aria-label":"Close"},[...o[1]||(o[1]=[e("span",{"aria-hidden":"true"},"×",-1)])])]),e("div",H,[p(D,{form:a,permissions:v.permissions,"editing-role":t.value,errors:n.value,onSubmit:y,onCancel:i},null,8,["form","permissions","editing-role","errors"])]),e("div",J,[e("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:i,style:{"font-size":"13px"}}," Cancel "),e("button",{type:"button",class:"btn btn-primary btn-sm",onClick:y,disabled:u.value,style:{"font-size":"13px"}},[u.value?(f(),m("span",O)):b("",!0),w(" "+h(t.value?"Update Role":"Create Role"),1)],8,K)])])])])):b("",!0)])]),l.value.show?(f(),m("div",{key:0,class:A(["toast-notification",l.value.type==="success"?"toast-success":"toast-error"]),style:{position:"fixed",top:"20px",right:"20px","z-index":"9999","min-width":"300px",padding:"12px 16px","border-radius":"8px",color:"white","font-weight":"500","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"}},[e("div",Q,[e("span",W,h(l.value.type==="success"?"✅":"❌"),1),e("span",null,h(l.value.message),1)])],2)):b("",!0)]),_:1})],64))}}),re=N(X,[["__scopeId","data-v-95b45e7e"]]);export{re as default};
