import{d as R,r as d,f as T,O as b,s as w,o as L,n as q,c as p,a as _,u as E,h as V,w as F,b as o,j as S,i as g,e as h,t as A,F as B}from"./app-EEW5rfl7.js";import{_ as I}from"./AppLayout.vue_vue_type_script_setup_true_lang-CNQNEmhQ.js";import{_ as M}from"./StepIndicator.vue_vue_type_script_setup_true_lang-uMzcFXNN.js";import{_ as z}from"./BuilderInformation.vue_vue_type_script_setup_true_lang-BkY--HAh.js";import{_ as D}from"./ProjectInformation.vue_vue_type_script_setup_true_lang-Bd7OdV4P.js";import{_ as x}from"./ContactDetails.vue_vue_type_script_setup_true_lang-B_talUCH.js";import{_ as O}from"./ChoiseSelection.vue_vue_type_script_setup_true_lang-B02qfULU.js";import{_ as G}from"./TowerDetailsSection.vue_vue_type_script_setup_true_lang-BOrO3SA9.js";import H from"./ParkingAndAmenities-CaQSSYA2.js";import"./plus-By4uKs1q.js";import"./createLucideIcon-BadnkGs4.js";import"./x-Cq7nhNrv.js";const J={class:"row"},K={class:"col-12"},Q={class:"card mb-4 mt-4"},W={class:"card-body"},X={class:"row"},Y={class:"col-md-3 col-lg-2"},Z={class:"col-md-9 col-lg-10"},ee={key:0},te={key:1},ae={key:2},ie={class:"d-flex justify-content-end gap-2 mt-4"},re=["disabled"],he=R({__name:"CreateProject",props:{builders:{},states:{},measurementUnits:{},users:{},constructionTypes:{},amenities:{}},setup(l){const $=l,k=[{title:"Dashboard",href:"/dashboard"},{title:"Create Project",href:"/projects/create"}],s=d(2),m=d(!1),i=d({}),v=d([]),n=d([]),c=d([{id:1,name:"",mobile:"",email:"",designation:""}]);let P=2;const e=T({builder_id:"",builder_website:"",project_name:"",address:"",state_id:"",city_id:"",locality_id:"",pincode:"",location_link:"",land_size:"",measurement_unit_id:"",rera_no:"",project_status:"",restricted_user_ids:[],construction_type_id:"",category_id:"",sub_category_id:"",no_of_towers:"",no_of_floors:"",total_units:"",no_of_unit_each_tower:"",no_of_lift:"",front_road_width:"",front_road_width_measurement_unit_id:"",washroom:"Private",towers_different_specification:!1,tower_details:[{tower_name:"",saleable_area_from:"",saleable_area_to:"",saleable_area_unit_id:"",ceiling_height:"",ceiling_height_unit_id:"",carpet_area_from:"",carpet_area_to:"",carpet_area_unit_id:"",builtup_area_from:"",builtup_area_to:"",builtup_area_unit_id:"",show_carpet_area:!1,show_builtup_area:!1}],free_allotted_parking_four_wheeler:!1,free_allotted_parking_two_wheeler:!1,available_for_purchase:!1,no_of_parking:"",total_floor_for_parking:"1",basement_parking:[{floor_no:"",ev_charging_point:"",hydraulic_parking:"",height_of_basement:"",height_of_basement_unit_id:""}],amenity_ids:[],document_uploads:[],brochure_file:null,remark:""}),C=()=>{c.value.push({id:P++,name:"",mobile:"",email:"",designation:""})},j=a=>{c.value.length>1&&(c.value=c.value.filter(t=>t.id!==a))};b(()=>e.no_of_towers,a=>{if(!e.towers_different_specification)return;const t=parseInt(a)||1,r=e.tower_details.length;if(t>r)for(let u=r;u<t;u++)e.tower_details.push({tower_name:"",saleable_area_from:"",saleable_area_to:"",saleable_area_unit_id:"",ceiling_height:"",ceiling_height_unit_id:"",carpet_area_from:"",carpet_area_to:"",carpet_area_unit_id:"",builtup_area_from:"",builtup_area_to:"",builtup_area_unit_id:"",show_carpet_area:!1,show_builtup_area:!1});else t<r&&t>0&&(e.tower_details=e.tower_details.slice(0,t));(t===0||!a)&&e.tower_details.length===0&&e.tower_details.push({tower_name:"",saleable_area_from:"",saleable_area_to:"",saleable_area_unit_id:"",ceiling_height:"",ceiling_height_unit_id:"",carpet_area_from:"",carpet_area_to:"",carpet_area_unit_id:"",builtup_area_from:"",builtup_area_to:"",builtup_area_unit_id:"",show_carpet_area:!1,show_builtup_area:!1})},{immediate:!1}),b(()=>e.towers_different_specification,a=>{if(!a)e.tower_details.length>1&&(e.tower_details=[e.tower_details[0]]);else{const t=parseInt(e.no_of_towers)||1,r=e.tower_details.length;if(t>r)for(let u=r;u<t;u++)e.tower_details.push({tower_name:"",saleable_area_from:"",saleable_area_to:"",saleable_area_unit_id:"",ceiling_height:"",ceiling_height_unit_id:"",carpet_area_from:"",carpet_area_to:"",carpet_area_unit_id:"",builtup_area_from:"",builtup_area_to:"",builtup_area_unit_id:"",show_carpet_area:!1,show_builtup_area:!1});else t<r&&t>0&&(e.tower_details=e.tower_details.slice(0,t));e.tower_details.length===0&&e.tower_details.push({tower_name:"",saleable_area_from:"",saleable_area_to:"",saleable_area_unit_id:"",ceiling_height:"",ceiling_height_unit_id:"",carpet_area_from:"",carpet_area_to:"",carpet_area_unit_id:"",builtup_area_from:"",builtup_area_to:"",builtup_area_unit_id:"",show_carpet_area:!1,show_builtup_area:!1})}},{immediate:!1}),b(()=>e.state_id,async a=>{if(a)try{const t=await w.get(`/states/${a}/cities`);v.value=t.data,e.city_id="",e.locality_id="",e.pincode="",n.value=[]}catch(t){console.error("Error loading cities:",t),v.value=[]}else v.value=[],e.city_id="",e.locality_id="",e.pincode="",n.value=[]}),b(()=>e.city_id,async a=>{if(a)try{const t=await w.get(`/cities/${a}/localities`);n.value=t.data,e.locality_id="",e.pincode=""}catch(t){console.error("Error loading localities:",t),n.value=[]}else n.value=[],e.locality_id="",e.pincode=""}),b(()=>e.locality_id,a=>{if(a){const t=n.value.find(r=>r.id===Number(a));t&&t.zip_code&&(e.pincode=t.zip_code)}else e.pincode=""});const f=()=>{i.value={};let a=!0;if((!e.builder_id||e.builder_id==="")&&(i.value.builder_id=["Builder Name is required"],a=!1),(!e.project_name||e.project_name.trim()==="")&&(i.value.project_name=["Project Name is required"],a=!1),(!e.locality_id||e.locality_id==="")&&(i.value.locality_id=["Locality is required"],a=!1),c.value.forEach((t,r)=>{(!t.name||t.name.trim()==="")&&(i.value[`contacts.${r}.name`]||(i.value[`contacts.${r}.name`]=[]),i.value[`contacts.${r}.name`].push("Name is required"),a=!1),(!t.mobile||t.mobile.trim()==="")&&(i.value[`contacts.${r}.mobile`]||(i.value[`contacts.${r}.mobile`]=[]),i.value[`contacts.${r}.mobile`].push("Mobile is required"),a=!1),t.mobile&&t.mobile.trim()!==""&&(/^[0-9]{10}$/.test(t.mobile.trim())||(i.value[`contacts.${r}.mobile`]||(i.value[`contacts.${r}.mobile`]=[]),i.value[`contacts.${r}.mobile`].push("Mobile must be 10 digits"),a=!1)),t.email&&t.email.trim()!==""&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email.trim())||(i.value[`contacts.${r}.email`]||(i.value[`contacts.${r}.email`]=[]),i.value[`contacts.${r}.email`].push("Please enter a valid email address"),a=!1))}),e.builder_website&&e.builder_website.trim()!=="")try{new URL(e.builder_website)}catch{i.value.builder_website=["Please enter a valid URL"],a=!1}if(e.location_link&&e.location_link.trim()!=="")try{new URL(e.location_link)}catch{i.value.location_link=["Please enter a valid URL"],a=!1}return a},y=async()=>{if(m.value=!0,i.value={},!f()){m.value=!1;const a=document.querySelector(".is-invalid");a&&a.scrollIntoView({behavior:"smooth",block:"center"});return}try{const a={...e,contacts:c.value};console.log("Form data:",a)}catch(a){console.error("Error creating project:",a),m.value=!1}},N=()=>{if(s.value===1){if(!f())return;s.value=2}else if(s.value===2){if(!e.construction_type_id){i.value.construction_type_id=["Please select a construction type"];return}if(!e.category_id){i.value.category_id=["Please select a category"];return}if(e.category_id){const a=$.constructionTypes.find(t=>t.id===Number(e.construction_type_id));if(a){const t=a.categories?.find(r=>r.id===Number(e.category_id));if(t&&t.sub_categories&&t.sub_categories.length>0&&!e.sub_category_id){i.value.sub_category_id=["Please select a sub-category"];return}}}s.value=3}else s.value===3&&y()},U=()=>{s.value>1&&s.value--};return L(()=>{q(()=>{typeof window.$<"u"&&window.$.fn.select2&&(window.$("#restricted_user_ids").select2({placeholder:"Select Restricted Users",allowClear:!0,width:"100%"}),window.$("#restricted_user_ids").on("change",function(){const a=window.$(this).val()||[];e.restricted_user_ids=Array.isArray(a)?a.map(t=>Number(t)):[]}))})}),(a,t)=>(h(),p(B,null,[_(E(V),{title:"Create Project"}),_(I,{breadcrumbs:k},{default:F(()=>[o("div",J,[o("div",K,[o("div",Q,[t[1]||(t[1]=o("div",{class:"card-header color-dark fw-500"},[o("h4",{class:"mb-0"},"Create Project")],-1)),o("div",W,[o("div",X,[o("div",Y,[_(M,{"current-step":s.value},null,8,["current-step"])]),o("div",Z,[o("form",{onSubmit:S(y,["prevent"])},[s.value===1?(h(),p("div",ee,[_(z,{builders:l.builders,form:e,errors:i.value,"validate-form":f},null,8,["builders","form","errors"]),_(D,{states:l.states,cities:v.value,localities:n.value,"measurement-units":l.measurementUnits,form:e,errors:i.value,"validate-form":f},null,8,["states","cities","localities","measurement-units","form","errors"]),_(x,{users:l.users,contacts:c.value,form:e,errors:i.value,"validate-form":f,"add-contact":C,"remove-contact":j},null,8,["users","contacts","form","errors"])])):g("",!0),s.value===2?(h(),p("div",te,[_(O,{"construction-types":l.constructionTypes,"model-value":{construction_type_id:e.construction_type_id,category_id:e.category_id,sub_category_id:e.sub_category_id},errors:i.value,"show-ids":!0,"onUpdate:modelValue":t[0]||(t[0]=r=>{e.construction_type_id=r.construction_type_id,e.category_id=r.category_id,e.sub_category_id=r.sub_category_id})},null,8,["construction-types","model-value","errors"]),_(G,{form:e,errors:i.value,"measurement-units":l.measurementUnits,condition:{constructionTypeId:"1",categoryId:"1",subCategoryId:"1"}},null,8,["form","errors","measurement-units"])])):g("",!0),s.value===3?(h(),p("div",ae,[_(H,{form:e,errors:i.value,amenities:l.amenities,"measurement-units":l.measurementUnits},null,8,["form","errors","amenities","measurement-units"])])):g("",!0),o("div",ie,[s.value>1?(h(),p("button",{key:0,type:"button",onClick:U,class:"btn btn-secondary btn-sm btn-previous"}," Previous ")):g("",!0),o("button",{type:"button",onClick:N,class:"btn btn-primary btn-sm btn-primary-custom",disabled:m.value},A(m.value?"Processing...":s.value===3?"Create Project":"Next"),9,re)])],32)])])])])])])]),_:1})],64))}});export{he as default};
