import{d as S,r as i,f as T,c as w,a as c,u as $,h as A,w as p,b as a,i as E,A as k,e as _,m as z,t as x,F,s as f,x as b,_ as N}from"./app-CvLl_M2Q.js";import{_ as V}from"./AppLayout.vue_vue_type_script_setup_true_lang-BxU0oBNB.js";import{M as D}from"./Modal-DIhtmqai.js";import{_ as M}from"./RoleForm.vue_vue_type_script_setup_true_lang-CQX788TZ.js";import{_ as Y}from"./RoleTable.vue_vue_type_script_setup_true_lang-BsTBaZpf.js";import{d as q}from"./index-BcgMG_W3.js";import"./index-CMWG4mbA.js";const I={class:"row"},P={class:"col-12"},U={class:"d-flex align-items-center"},j={class:"me-2",style:{"font-size":"18px"}},G=S({__name:"Roles",props:{roles:{},permissions:{}},setup(h){const g=[{title:"Dashboard",href:q().url},{title:"Roles",href:"/roles"}],u=i(!1),s=i(null),m=i(!1),n=i({}),r=i({show:!1,message:"",type:"success"}),o=T({name:"",permissions:[]}),d=()=>{o.name="",o.permissions=[],n.value={},s.value=null,u.value=!1},l=(e,t="success")=>{r.value={show:!0,message:e,type:t},setTimeout(()=>{r.value.show=!1},3e3)},y=e=>{s.value=e,o.name=e.name,o.permissions=e.permissions.map(t=>t.name),n.value={},u.value=!0},R=()=>{d(),u.value=!0},v=async()=>{m.value=!0,n.value={};try{s.value?(await f.put(`/roles/${s.value.id}`,o),l("Role updated successfully!")):(await f.post("/roles",o),l("Role created successfully!")),d(),b.reload()}catch(e){e.response?.status===422?(n.value=e.response.data.errors,l("Please fix the validation errors.","error")):(console.error("Error saving role:",e),l("An error occurred while saving the role.","error"))}finally{m.value=!1}},C=async e=>{if((await window.Swal.fire({title:"Are you sure?",text:`You are about to delete the role "${e.name}". This action cannot be undone!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{await f.delete(`/roles/${e.id}`),l("Role deleted successfully!"),b.reload()}catch(B){console.error("Error deleting role:",B),l("An error occurred while deleting the role.","error")}};return(e,t)=>(_(),w(F,null,[c($(A),{title:"Roles Management"}),c(V,{breadcrumbs:g},{default:p(()=>[a("div",I,[a("div",P,[c(Y,{roles:h.roles,onEdit:y,onDelete:C},{"header-action":p(()=>[a("button",{onClick:R,class:"btn btn-primary btn-sm btn-default btn-squared text-capitalize lh-normal px-3 py-2"},[...t[0]||(t[0]=[a("span",{"data-feather":"plus",class:"me-1"},null,-1),k(" Add Role ",-1)])])]),_:1},8,["roles"]),c(D,{show:u.value,title:s.value?"Edit Role":"Create Role",loading:m.value,"submit-label":s.value?"Update Role":"Create Role",onClose:d,onSubmit:v},{default:p(()=>[c(M,{form:o,permissions:h.permissions,"editing-role":s.value,errors:n.value,onSubmit:v,onCancel:d},null,8,["form","permissions","editing-role","errors"])]),_:1},8,["show","title","loading","submit-label"])])]),r.value.show?(_(),w("div",{key:0,class:z(["toast-notification",r.value.type==="success"?"toast-success":"toast-error"]),style:{position:"fixed",top:"20px",right:"20px","z-index":"9999","min-width":"300px",padding:"12px 16px","border-radius":"8px",color:"white","font-weight":"500","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"}},[a("div",U,[a("span",j,x(r.value.type==="success"?"✅":"❌"),1),a("span",null,x(r.value.message),1)])],2)):E("",!0)]),_:1})],64))}}),Z=N(G,[["__scopeId","data-v-29b3a549"]]);export{Z as default};
