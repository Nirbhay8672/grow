import{d as T,r as n,f as $,c as h,a as c,u as z,h as A,w as f,b as a,i as E,A as k,e as y,m as D,t as C,F,s as p,x as w,_ as N}from"./app-ujE8Vp_h.js";import{_ as V}from"./AppLayout.vue_vue_type_script_setup_true_lang-CHpGfBAA.js";import{M}from"./Modal-BlDpeJj7.js";import{_ as I}from"./CityForm.vue_vue_type_script_setup_true_lang-BGnUdyIM.js";import{_ as Y}from"./CityTable.vue_vue_type_script_setup_true_lang-BfsK-bE4.js";import{d as q}from"./index-BcgMG_W3.js";import"./index-CMWG4mbA.js";const P={class:"row"},U={class:"col-12"},j={class:"d-flex align-items-center"},G={class:"me-2",style:{"font-size":"18px"}},H=T({__name:"Cities",props:{cities:{},states:{}},setup(v){const x=[{title:"Dashboard",href:q().url},{title:"Cities",href:"/cities"}],u=n(!1),s=n(null),m=n(!1),r=n({}),o=n({show:!1,message:"",type:"success"}),t=$({name:"",state_id:"",is_active:!0}),d=()=>{t.name="",t.state_id="",t.is_active=!0,r.value={},s.value=null,u.value=!1},i=(e,l="success")=>{o.value={show:!0,message:e,type:l},setTimeout(()=>{o.value.show=!1},3e3)},b=e=>{s.value=e,t.name=e.name,t.state_id=e.state_id.toString(),t.is_active=e.is_active,r.value={},u.value=!0},g=()=>{d(),u.value=!0},_=async()=>{m.value=!0,r.value={};try{const e={...t,state_id:parseInt(t.state_id)};s.value?(await p.put(`/cities/${s.value.id}`,e),i("City updated successfully!")):(await p.post("/cities",e),i("City created successfully!")),d(),w.reload()}catch(e){e.response?.status===422?(r.value=e.response.data.errors,i("Please fix the validation errors.","error")):(console.error("Error saving city:",e),i("An error occurred while saving the city.","error"))}finally{m.value=!1}},B=async e=>{if((await window.Swal.fire({title:"Are you sure?",text:`You are about to delete the city "${e.name}". This action cannot be undone!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{await p.delete(`/cities/${e.id}`),i("City deleted successfully!"),w.reload()}catch(S){console.error("Error deleting city:",S),i("An error occurred while deleting the city.","error")}};return(e,l)=>(y(),h(F,null,[c(z(A),{title:"Cities Management"}),c(V,{breadcrumbs:x},{default:f(()=>[a("div",P,[a("div",U,[c(Y,{cities:v.cities,onEdit:b,onDelete:B},{"header-action":f(()=>[a("button",{onClick:g,class:"btn btn-primary btn-sm btn-default btn-squared text-capitalize lh-normal px-3 py-2"},[...l[0]||(l[0]=[a("span",{"data-feather":"plus",class:"me-1"},null,-1),k(" Add City ",-1)])])]),_:1},8,["cities"]),c(M,{show:u.value,title:s.value?"Edit City":"Create City",loading:m.value,"submit-label":s.value?"Update City":"Create City",size:"sm",onClose:d,onSubmit:_},{default:f(()=>[c(I,{form:t,states:v.states,"editing-city":s.value,errors:r.value,onSubmit:_,onCancel:d},null,8,["form","states","editing-city","errors"])]),_:1},8,["show","title","loading","submit-label"])])]),o.value.show?(y(),h("div",{key:0,class:D(["toast-notification",o.value.type==="success"?"toast-success":"toast-error"]),style:{position:"fixed",top:"20px",right:"20px","z-index":"9999","min-width":"300px",padding:"12px 16px","border-radius":"8px",color:"white","font-weight":"500","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"}},[a("div",j,[a("span",G,C(o.value.type==="success"?"✅":"❌"),1),a("span",null,C(o.value.message),1)])],2)):E("",!0)]),_:1})],64))}}),Z=N(H,[["__scopeId","data-v-00518b42"]]);export{Z as default};
