import{d as C,h as p,s as T,p as g,c as l,a as t,w as h,b as f,v as D,n as _,F as $,r as k,t as o,e as L,f as A,o as n,g as N,i as U,j as w,u as q,k as F,l as I,m as z,q as S}from"./app-CgPUzVT5.js";import{_ as j}from"./AppLayout.vue_vue_type_script_setup_true_lang-pdvKlhoS.js";import{d as Y}from"./index-BcgMG_W3.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CMWG4mbA.js";const G={class:"space-y-4"},P={class:"form-group"},R=["value"],H={key:0,class:"invalid-feedback"},J={class:"form-group"},K=["disabled"],O=["value"],Q={key:0,class:"invalid-feedback"},W={class:"form-group"},X={key:0,class:"invalid-feedback"},tt={class:"form-group"},et={key:0,class:"invalid-feedback"},st={class:"form-group"},at={class:"form-check"},it=C({__name:"LocalityForm",props:{form:{},states:{},editingLocality:{},errors:{}},emits:["submit","cancel"],setup(a,{emit:y}){const u=a,c=p([]);return T(()=>u.form.state_id,async d=>{if(d)try{const e=await g.get(`/states/${d}/cities`);c.value=e.data}catch(e){console.error("Error fetching cities:",e),c.value=[]}else c.value=[],u.form.city_id=""},{immediate:!0}),u.editingLocality&&g.get(`/states/${u.editingLocality.state_id}/cities`).then(d=>{c.value=d.data}),(d,e)=>(n(),l("div",G,[t("div",P,[e[6]||(e[6]=t("label",{for:"state_id",class:"form-label"}," State ",-1)),h(t("select",{id:"state_id","onUpdate:modelValue":e[0]||(e[0]=s=>a.form.state_id=s),class:_(["form-control",{"is-invalid":a.errors.state_id}]),required:""},[e[5]||(e[5]=t("option",{value:""},"Select a state",-1)),(n(!0),l($,null,k(a.states,s=>(n(),l("option",{key:s.id,value:s.id},o(s.name)+" ("+o(s.code)+") ",9,R))),128))],2),[[D,a.form.state_id]]),a.errors.state_id?(n(),l("div",H,o(a.errors.state_id[0]),1)):f("",!0)]),t("div",J,[e[8]||(e[8]=t("label",{for:"city_id",class:"form-label"}," City ",-1)),h(t("select",{id:"city_id","onUpdate:modelValue":e[1]||(e[1]=s=>a.form.city_id=s),class:_(["form-control",{"is-invalid":a.errors.city_id}]),disabled:!a.form.state_id,required:""},[e[7]||(e[7]=t("option",{value:""},"Select a city",-1)),(n(!0),l($,null,k(c.value,s=>(n(),l("option",{key:s.id,value:s.id},o(s.name),9,O))),128))],10,K),[[D,a.form.city_id]]),a.errors.city_id?(n(),l("div",Q,o(a.errors.city_id[0]),1)):f("",!0)]),t("div",W,[e[9]||(e[9]=t("label",{for:"name",class:"form-label"}," Locality Name ",-1)),h(t("input",{id:"name","onUpdate:modelValue":e[2]||(e[2]=s=>a.form.name=s),type:"text",class:_(["form-control",{"is-invalid":a.errors.name}]),placeholder:"Enter locality name",required:""},null,2),[[L,a.form.name]]),a.errors.name?(n(),l("div",X,o(a.errors.name[0]),1)):f("",!0)]),t("div",tt,[e[10]||(e[10]=t("label",{for:"zip_code",class:"form-label"}," Zip Code ",-1)),h(t("input",{id:"zip_code","onUpdate:modelValue":e[3]||(e[3]=s=>a.form.zip_code=s),type:"text",class:_(["form-control",{"is-invalid":a.errors.zip_code}]),placeholder:"Enter zip code",required:""},null,2),[[L,a.form.zip_code]]),a.errors.zip_code?(n(),l("div",et,o(a.errors.zip_code[0]),1)):f("",!0)]),t("div",st,[t("div",at,[h(t("input",{id:"is_active","onUpdate:modelValue":e[4]||(e[4]=s=>a.form.is_active=s),type:"checkbox",class:"form-check-input"},null,512),[[A,a.form.is_active]]),e[11]||(e[11]=t("label",{for:"is_active",class:"form-check-label"}," Active ",-1))])])]))}}),ot={class:"card"},lt={class:"card-body p-0"},nt={class:"table4 p-25 bg-white mb-30"},dt={class:"table-responsive"},rt={class:"table mb-0"},ct={class:"userDatatable-content"},ut={class:"d-flex align-items-center"},mt={class:"userDatatable-inline-title"},vt={href:"#",class:"text-dark fw-500"},ft={class:"userDatatable-content"},bt={class:"bg-opacity-primary color-primary rounded-pill userDatatable-content-status active"},pt={class:"userDatatable-content"},_t={class:"bg-opacity-info color-info rounded-pill userDatatable-content-status active"},yt={class:"userDatatable-content"},ht={class:"badge bg-primary"},gt={class:"userDatatable-content"},xt={class:"userDatatable-content"},wt={class:"userDatatable-content"},$t={class:"d-flex align-items-center gap-2"},kt=["onClick"],Ct=["onClick"],Dt={key:0,class:"text-center py-5"},Lt=C({__name:"LocalityTable",props:{localities:{}},emits:["edit","delete"],setup(a,{emit:y}){const u=y,c=d=>new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return N(()=>{typeof window<"u"&&window.feather&&window.feather.replace()}),(d,e)=>(n(),l("div",ot,[e[2]||(e[2]=t("div",{class:"card-header color-dark fw-500"}," Localities Management ",-1)),t("div",lt,[t("div",nt,[t("div",dt,[t("table",rt,[e[0]||(e[0]=t("thead",null,[t("tr",{class:"userDatatable-header"},[t("th",null,[t("span",{class:"userDatatable-title"},"Locality Name")]),t("th",null,[t("span",{class:"userDatatable-title"},"City")]),t("th",null,[t("span",{class:"userDatatable-title"},"State")]),t("th",null,[t("span",{class:"userDatatable-title"},"Zip Code")]),t("th",null,[t("span",{class:"userDatatable-title"},"Status")]),t("th",null,[t("span",{class:"userDatatable-title"},"Created")]),t("th",null,[t("span",{class:"userDatatable-title"},"Actions")])])],-1)),t("tbody",null,[(n(!0),l($,null,k(a.localities,s=>(n(),l("tr",{key:s.id},[t("td",null,[t("div",ct,[t("div",ut,[t("div",mt,[t("a",vt,o(s.name),1)])])])]),t("td",null,[t("div",ft,[t("span",bt,o(s.city.name),1)])]),t("td",null,[t("div",pt,[t("span",_t,o(s.state.name)+" ("+o(s.state.code)+") ",1)])]),t("td",null,[t("div",yt,[t("span",ht,o(s.zip_code),1)])]),t("td",null,[t("div",gt,[t("span",{class:_(["rounded-pill userDatatable-content-status",s.is_active?"bg-opacity-success color-success active":"bg-opacity-danger color-danger"])},o(s.is_active?"Active":"Inactive"),3)])]),t("td",null,[t("div",xt,o(c(s.created_at)),1)]),t("td",null,[t("div",wt,[t("div",$t,[t("button",{onClick:v=>u("edit",s),class:"btn btn-sm btn-outline-primary",title:"Edit Locality",style:{padding:"4px 8px","min-width":"32px",height:"32px"}}," ✏️ ",8,kt),t("button",{onClick:v=>u("delete",s),class:"btn btn-sm btn-outline-danger",title:"Delete Locality",style:{padding:"4px 8px","min-width":"32px",height:"32px"}}," 🗑️ ",8,Ct)])])])]))),128))])])])])]),a.localities.length===0?(n(),l("div",Dt,[...e[1]||(e[1]=[t("div",{class:"mb-3"},[t("span",{style:{"font-size":"48px"}},"🏘️")],-1),t("h6",{class:"text-muted"},"No localities found",-1),t("p",{class:"text-muted mb-0"},"Get started by creating a new locality.",-1)])])):f("",!0)]))}}),zt={class:"row"},St={class:"col-12"},Bt={key:0,class:"modal fade show d-block",tabindex:"-1",role:"dialog","aria-hidden":"false",style:{"background-color":"rgba(0,0,0,0.5)"}},Vt={class:"modal-dialog modal-lg modal-dialog-centered",role:"document"},Et={class:"modal-content"},Mt={class:"modal-header"},Tt={class:"modal-title"},At={class:"modal-body"},Nt={class:"modal-footer"},Ut=["disabled"],qt={key:0,class:"spinner-border spinner-border-sm me-1"},Ft={class:"d-flex align-items-center"},It={class:"me-2",style:{"font-size":"18px"}},jt=C({__name:"Localities",props:{localities:{},states:{}},setup(a){const y=a,u=[{title:"Dashboard",href:Y().url},{title:"Localities",href:"/localities"}],c=p(!1),d=p(null),e=p(!1),s=p({}),v=p({show:!1,message:"",type:"success"}),r=U({name:"",zip_code:"",state_id:"",city_id:"",is_active:!0}),x=()=>{r.name="",r.zip_code="",r.state_id="",r.city_id="",r.is_active=!0,s.value={},d.value=null,c.value=!1},B=()=>{x(),c.value=!0},V=i=>{d.value=i,r.name=i.name,r.zip_code=i.zip_code,r.state_id=i.state_id.toString(),r.city_id=i.city_id.toString(),r.is_active=i.is_active,s.value={},c.value=!0},b=(i,m="success")=>{v.value={show:!0,message:i,type:m},setTimeout(()=>{v.value.show=!1},3e3)},E=async()=>{e.value=!0,s.value={};try{const i={name:r.name,zip_code:r.zip_code,state_id:parseInt(r.state_id),city_id:parseInt(r.city_id),is_active:r.is_active};d.value?(await g.put(`/localities/${d.value.id}`,i),b("Locality updated successfully!")):(await g.post("/localities",i),b("Locality created successfully!")),x(),S.reload()}catch(i){i.response?.status===422?(s.value=i.response.data.errors,b("Please fix the validation errors.","error")):b("An error occurred while saving the locality.","error")}finally{e.value=!1}},M=async i=>{if((await window.Swal.fire({title:"Are you sure?",text:`You are about to delete the locality "${i.name}". This action cannot be undone!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{await g.delete(`/localities/${i.id}`),b("Locality deleted successfully!"),S.reload()}catch{b("An error occurred while deleting the locality.","error")}};return(i,m)=>(n(),l($,null,[w(q(F),{title:"Localities Management"}),w(j,{breadcrumbs:u},{default:I(()=>[t("div",zt,[t("div",St,[t("div",{class:"d-flex justify-content-between align-items-center mb-30 mt-4"},[m[1]||(m[1]=t("div",null,[t("h4",{class:"color-dark fw-500"},"Localities Management"),t("p",{class:"text-muted mb-0"},"Manage localities (name, zip, state, city)")],-1)),t("button",{onClick:B,class:"btn btn-primary btn-default btn-squared text-capitalize lh-normal px-50 py-15"},[...m[0]||(m[0]=[t("span",{"data-feather":"plus",class:"me-1"},null,-1),z(" Add Locality ",-1)])])]),w(Lt,{localities:y.localities,onEdit:V,onDelete:M},null,8,["localities"]),c.value?(n(),l("div",Bt,[t("div",Vt,[t("div",Et,[t("div",Mt,[t("h5",Tt,o(d.value?"Edit Locality":"Create Locality"),1),t("button",{type:"button",class:"btn-close",onClick:x,"aria-label":"Close"},[...m[2]||(m[2]=[t("span",{"aria-hidden":"true"},"×",-1)])])]),t("div",At,[w(it,{form:r,states:y.states,"editing-locality":d.value,errors:s.value},null,8,["form","states","editing-locality","errors"])]),t("div",Nt,[t("button",{type:"button",class:"btn btn-secondary",onClick:x},"Cancel"),t("button",{type:"button",class:"btn btn-primary",onClick:E,disabled:e.value},[e.value?(n(),l("span",qt)):f("",!0),z(" "+o(d.value?"Update Locality":"Create Locality"),1)],8,Ut)])])])])):f("",!0)])]),v.value.show?(n(),l("div",{key:0,class:_(["toast-notification",v.value.type==="success"?"toast-success":"toast-error"]),style:{position:"fixed",top:"20px",right:"20px","z-index":"9999","min-width":"300px",padding:"12px 16px","border-radius":"8px",color:"white","font-weight":"500","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"}},[t("div",Ft,[t("span",It,o(v.value.type==="success"?"✅":"❌"),1),t("span",null,o(v.value.message),1)])],2)):f("",!0)]),_:1})],64))}}),Kt=Z(jt,[["__scopeId","data-v-5bfd4cd1"]]);export{Kt as default};
