import{d as C,x as M,c as a,a as e,w as P,b as v,e as A,n as E,t as h,F as g,r as $,o as l,g as T,h as y,i as F,j as w,u as z,k as N,l as V,m as D,p as k,q as S}from"./app-CtIQcBuM.js";import{_ as L}from"./AppLayout.vue_vue_type_script_setup_true_lang-BJZPRBDV.js";import{d as j}from"./index-BcgMG_W3.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CMWG4mbA.js";const U={class:"space-y-4"},O={class:"form-group"},Y={key:0,class:"invalid-feedback"},G={class:"form-group"},I={class:"row"},H={class:"card"},J={class:"card-header d-flex justify-content-between align-items-center"},K={class:"mb-0 text-capitalize"},Q=["onClick"],W={class:"card-body"},X={class:"row"},Z={class:"form-check"},ee=["id","checked","onChange"],se=["for"],te=C({__name:"RoleForm",props:{form:{},permissions:{},editingRole:{},errors:{}},emits:["submit","cancel"],setup(b,{emit:x}){const n=b,d=M(()=>{const t={};return n.permissions.forEach(s=>{const[i]=s.name.split(".");t[i]||(t[i]=[]),t[i].push(s)}),t}),f=t=>n.form.permissions.includes(t),r=t=>{const s=[...n.form.permissions],i=s.indexOf(t);i>-1?s.splice(i,1):s.push(t),n.form.permissions=s},o=t=>{const s=d.value[t];s.every(u=>f(u.name))?s.forEach(u=>{const m=n.form.permissions.indexOf(u.name);m>-1&&n.form.permissions.splice(m,1)}):s.forEach(u=>{n.form.permissions.includes(u.name)||n.form.permissions.push(u.name)})},c=t=>d.value[t].every(i=>f(i.name));return(t,s)=>(l(),a("div",U,[e("div",O,[s[1]||(s[1]=e("label",{for:"name",class:"form-label"}," Role Name ",-1)),P(e("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=i=>b.form.name=i),type:"text",class:E(["form-control",{"is-invalid":b.errors.name}]),placeholder:"Enter role name",required:""},null,2),[[A,b.form.name]]),b.errors.name?(l(),a("div",Y,h(b.errors.name[0]),1)):v("",!0)]),e("div",G,[s[2]||(s[2]=e("label",{class:"form-label"}," Permissions ",-1)),e("div",I,[(l(!0),a(g,null,$(d.value,(i,u)=>(l(),a("div",{key:u,class:"col-md-6 mb-3"},[e("div",H,[e("div",J,[e("h6",K,h(u)+" Management ",1),e("button",{type:"button",onClick:m=>o(u),class:"btn btn-sm btn-outline-primary"},h(c(u)?"Deselect All":"Select All"),9,Q)]),e("div",W,[e("div",X,[(l(!0),a(g,null,$(i,m=>(l(),a("div",{key:m.id,class:"col-6 mb-2"},[e("div",Z,[e("input",{id:`permission-${m.id}`,type:"checkbox",checked:f(m.name),onChange:R=>r(m.name),class:"form-check-input"},null,40,ee),e("label",{for:`permission-${m.id}`,class:"form-check-label"},h(m.name.split(".")[1]),9,se)])]))),128))])])])]))),128))])])]))}}),oe={class:"card"},ae={class:"card-body p-0"},le={class:"table4 p-25 bg-white mb-30"},ne={class:"table-responsive"},ie={class:"table mb-0"},re={class:"userDatatable-content"},ce={class:"d-flex align-items-center"},de={class:"userDatatable-inline-title"},ue={href:"#",class:"text-dark fw-500"},me={class:"d-block mb-0"},pe={class:"text-muted"},he={class:"userDatatable-content"},be={class:"d-flex flex-wrap"},fe={key:0,class:"bg-opacity-secondary color-secondary rounded-pill userDatatable-content-status me-1 mb-1"},_e={class:"userDatatable-content"},ve={class:"userDatatable-content"},ye={class:"d-flex align-items-center gap-2"},ge=["onClick"],xe=["onClick"],we={key:0,class:"text-center py-5"},$e=C({__name:"RoleTable",props:{roles:{}},emits:["edit","delete"],setup(b,{emit:x}){const n=x,d=f=>new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return T(()=>{typeof window<"u"&&window.feather&&window.feather.replace()}),(f,r)=>(l(),a("div",oe,[r[2]||(r[2]=e("div",{class:"card-header color-dark fw-500"}," Roles Management ",-1)),e("div",ae,[e("div",le,[e("div",ne,[e("table",ie,[r[0]||(r[0]=e("thead",null,[e("tr",{class:"userDatatable-header"},[e("th",null,[e("span",{class:"userDatatable-title"},"Role Name")]),e("th",null,[e("span",{class:"userDatatable-title"},"Permissions")]),e("th",null,[e("span",{class:"userDatatable-title"},"Created")]),e("th",null,[e("span",{class:"userDatatable-title"},"Actions")])])],-1)),e("tbody",null,[(l(!0),a(g,null,$(b.roles,o=>(l(),a("tr",{key:o.id},[e("td",null,[e("div",re,[e("div",ce,[e("div",de,[e("a",ue,h(o.name),1),e("p",me,[e("span",pe,h(o.guard_name),1)])])])])]),e("td",null,[e("div",he,[e("div",be,[(l(!0),a(g,null,$(o.permissions.slice(0,3),c=>(l(),a("span",{key:c.id,class:"bg-opacity-primary color-primary rounded-pill userDatatable-content-status active me-1 mb-1"},h(c.name.split(".")[1]),1))),128)),o.permissions.length>3?(l(),a("span",fe," +"+h(o.permissions.length-3)+" more ",1)):v("",!0)])])]),e("td",null,[e("div",_e,h(d(o.created_at)),1)]),e("td",null,[e("div",ve,[e("div",ye,[e("button",{onClick:c=>n("edit",o),class:"btn btn-sm btn-outline-primary",title:"Edit Role",style:{padding:"4px 8px","min-width":"32px",height:"32px"}}," ‚úèÔ∏è ",8,ge),e("button",{onClick:c=>n("delete",o),class:"btn btn-sm btn-outline-danger",title:"Delete Role",style:{padding:"4px 8px","min-width":"32px",height:"32px"}}," üóëÔ∏è ",8,xe)])])])]))),128))])])])])]),b.roles.length===0?(l(),a("div",we,[...r[1]||(r[1]=[e("div",{class:"mb-3"},[e("span",{style:{"font-size":"48px"}},"üõ°Ô∏è")],-1),e("h6",{class:"text-muted"},"No roles found",-1),e("p",{class:"text-muted mb-0"},"Get started by creating a new role.",-1)])])):v("",!0)]))}}),ke={class:"row"},Ce={class:"col-12"},Re={key:0,class:"modal fade show d-block",tabindex:"-1",role:"dialog","aria-labelledby":"roleModalLabel","aria-hidden":"false",style:{"background-color":"rgba(0,0,0,0.5)"}},De={class:"modal-dialog modal-lg modal-dialog-centered",role:"document"},Se={class:"modal-content"},Ee={class:"modal-header"},Be={class:"modal-title",id:"roleModalLabel"},Me={class:"modal-body"},Pe={class:"modal-footer"},Ae=["disabled"],Te={key:0,class:"spinner-border spinner-border-sm me-1"},Fe={class:"d-flex align-items-center"},ze={class:"me-2",style:{"font-size":"18px"}},Ne=C({__name:"Roles",props:{roles:{},permissions:{}},setup(b){const x=[{title:"Dashboard",href:j().url},{title:"Roles",href:"/roles"}],n=y(!1),d=y(null),f=y(!1),r=y({}),o=y({show:!1,message:"",type:"success"}),c=F({name:"",permissions:[]}),t=()=>{c.name="",c.permissions=[],r.value={},d.value=null,n.value=!1},s=(p,_="success")=>{o.value={show:!0,message:p,type:_},setTimeout(()=>{o.value.show=!1},3e3)},i=p=>{d.value=p,c.name=p.name,c.permissions=p.permissions.map(_=>_.name),r.value={},n.value=!0},u=()=>{t(),n.value=!0},m=async()=>{f.value=!0,r.value={};try{d.value?(await k.put(`/roles/${d.value.id}`,c),s("Role updated successfully!")):(await k.post("/roles",c),s("Role created successfully!")),t(),S.reload()}catch(p){p.response?.status===422?(r.value=p.response.data.errors,s("Please fix the validation errors.","error")):(console.error("Error saving role:",p),s("An error occurred while saving the role.","error"))}finally{f.value=!1}},R=async p=>{if((await window.Swal.fire({title:"Are you sure?",text:`You are about to delete the role "${p.name}". This action cannot be undone!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{await k.delete(`/roles/${p.id}`),s("Role deleted successfully!"),S.reload()}catch(B){console.error("Error deleting role:",B),s("An error occurred while deleting the role.","error")}};return(p,_)=>(l(),a(g,null,[w(z(N),{title:"Roles Management"}),w(L,{breadcrumbs:x},{default:V(()=>[e("div",ke,[e("div",Ce,[e("div",{class:"d-flex justify-content-between align-items-center mb-30 mt-4"},[_[1]||(_[1]=e("div",null,[e("h4",{class:"color-dark fw-500"},"Roles Management"),e("p",{class:"text-muted mb-0"},"Manage user roles and their permissions")],-1)),e("button",{onClick:u,class:"btn btn-primary btn-default btn-squared text-capitalize lh-normal px-50 py-15"},[..._[0]||(_[0]=[e("span",{"data-feather":"plus",class:"me-1"},null,-1),D(" Add Role ",-1)])])]),w($e,{roles:b.roles,onEdit:i,onDelete:R},null,8,["roles"]),n.value?(l(),a("div",Re,[e("div",De,[e("div",Se,[e("div",Ee,[e("h5",Be,h(d.value?"Edit Role":"Create Role"),1),e("button",{type:"button",class:"btn-close",onClick:t,"aria-label":"Close"},[..._[2]||(_[2]=[e("span",{"aria-hidden":"true"},"√ó",-1)])])]),e("div",Me,[w(te,{form:c,permissions:b.permissions,"editing-role":d.value,errors:r.value,onSubmit:m,onCancel:t},null,8,["form","permissions","editing-role","errors"])]),e("div",Pe,[e("button",{type:"button",class:"btn btn-secondary",onClick:t}," Cancel "),e("button",{type:"button",class:"btn btn-primary",onClick:m,disabled:f.value},[f.value?(l(),a("span",Te)):v("",!0),D(" "+h(d.value?"Update Role":"Create Role"),1)],8,Ae)])])])])):v("",!0)])]),o.value.show?(l(),a("div",{key:0,class:E(["toast-notification",o.value.type==="success"?"toast-success":"toast-error"]),style:{position:"fixed",top:"20px",right:"20px","z-index":"9999","min-width":"300px",padding:"12px 16px","border-radius":"8px",color:"white","font-weight":"500","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"}},[e("div",Fe,[e("span",ze,h(o.value.type==="success"?"‚úÖ":"‚ùå"),1),e("span",null,h(o.value.message),1)])],2)):v("",!0)]),_:1})],64))}}),Ye=q(Ne,[["__scopeId","data-v-367b9541"]]);export{Ye as default};
