import{d as q,f as M,r as v,g as B,o as D,c as i,a as z,u as F,h as T,w as j,b as e,i as d,j as I,k as c,m as u,v as p,e as n,t as r,F as x,p as U,q as V,s as C,n as L,x as $,_ as O}from"./app-vsHvR4hc.js";import{_ as R}from"./AppLayout.vue_vue_type_script_setup_true_lang-DDFWEhqg.js";import{p as A}from"./index-BcgMG_W3.js";import"./index-CMWG4mbA.js";const G={class:"row"},H={class:"col-12"},J={class:"card mt-4"},K={class:"card-body"},Q={class:"row"},W={class:"col-md-4 mb-2"},X={class:"form-group"},Y={key:0,class:"invalid-feedback",style:{"font-size":"12px"}},Z={class:"col-md-4 mb-2"},ee={class:"form-group"},se={key:0,class:"invalid-feedback",style:{"font-size":"12px"}},te={class:"col-md-4 mb-2"},ae={class:"form-group"},oe={key:0,class:"invalid-feedback",style:{"font-size":"12px"}},le={class:"col-md-4 mb-2"},ie={class:"form-group"},ne={key:0,class:"invalid-feedback",style:{"font-size":"12px"}},re={class:"col-md-4 mb-2"},de={class:"form-group"},me={key:0,class:"invalid-feedback",style:{"font-size":"12px"}},ue={class:"col-md-4 mb-2"},ce={class:"form-group"},pe={key:0,class:"invalid-feedback",style:{"font-size":"12px"}},fe={class:"col-md-4 mb-2"},_e={class:"form-group"},ve={key:0,class:"invalid-feedback",style:{"font-size":"12px"}},be={class:"col-md-4 mb-2"},ye={class:"form-group"},xe={key:0,class:"invalid-feedback",style:{"font-size":"12px"}},he={class:"col-md-4 mb-2"},we={class:"form-group"},ge={key:0,class:"invalid-feedback",style:{"font-size":"12px"}},ke={class:"col-md-4 mb-2"},ze={class:"form-group"},Ue=["value"],Ve={key:0,class:"invalid-feedback",style:{"font-size":"12px"}},Ce={class:"col-md-4 mb-2"},Ee={class:"form-group"},Ne=["disabled"],Pe=["value"],Se={key:0,class:"form-text",style:{"font-size":"12px"}},qe={key:1,class:"invalid-feedback",style:{"font-size":"12px"}},Me={class:"col-md-4 mb-2"},Be={class:"form-group"},De={key:0,class:"invalid-feedback",style:{"font-size":"12px"}},Fe={class:"col-md-4 mb-2"},Te={class:"form-group"},je={key:0,class:"invalid-feedback",style:{"font-size":"12px"}},Ie={class:"d-flex justify-content-end gap-2"},Le=["disabled"],$e={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},Oe={key:1},Re={key:2},Ae={class:"d-flex align-items-center"},Ge={class:"me-2",style:{"font-size":"18px"}},He=q({__name:"Profile",props:{user:{},states:{}},setup(h){const l=h,E=[{title:"Profile",href:A().url}],t=M({name:l.user.name||"",username:l.user.username||"",first_name:l.user.first_name||"",middle_name:l.user.middle_name||"",last_name:l.user.last_name||"",mobile:l.user.mobile||"",email:l.user.email||"",company_name:l.user.company_name||"",birth_date:l.user.birth_date||"",state_id:l.user.state_id||"",city_id:l.user.city_id||"",password:"",password_confirmation:""}),b=v([]),y=v(!1),_=v(!1),a=v({}),f=v({show:!1,message:"",type:"success"}),w=B({get:()=>t.birth_date?typeof t.birth_date=="string"&&t.birth_date.match(/^\d{4}-\d{2}-\d{2}$/)?t.birth_date:typeof t.birth_date=="string"?t.birth_date.split("T")[0]:"":"",set:m=>{t.birth_date=m}}),g=async m=>{if(m){y.value=!0;try{const s=await C.get(`/states/${m}/cities`);b.value=s.data}catch(s){console.error("Error loading cities:",s),b.value=[]}finally{y.value=!1}}},N=async()=>{t.state_id?(await g(t.state_id),t.city_id=""):(b.value=[],t.city_id="")};D(async()=>{l.user.state_id&&await g(l.user.state_id)});const k=(m,s="success")=>{f.value={show:!0,message:m,type:s},setTimeout(()=>{f.value.show=!1},3e3)},P=async()=>{a.value={},_.value=!0,await L();try{const m={name:t.name,username:t.username,first_name:t.first_name,last_name:t.last_name,middle_name:t.middle_name||null,mobile:t.mobile||null,email:t.email,company_name:t.company_name||null,birth_date:t.birth_date||null,state_id:t.state_id?parseInt(String(t.state_id)):null,city_id:t.city_id?parseInt(String(t.city_id)):null};t.password&&(m.password=t.password,m.password_confirmation=t.password_confirmation);const s=await C.put("/profile",m);k("Profile updated successfully!"),$.reload({only:["user"]})}catch(m){_.value=!1,m.response?.status===422?a.value=m.response.data.errors:k("Error updating profile. Please try again.","error")}},S=()=>{Object.assign(t,{name:l.user.name||"",username:l.user.username||"",first_name:l.user.first_name||"",middle_name:l.user.middle_name||"",last_name:l.user.last_name||"",mobile:l.user.mobile||"",email:l.user.email||"",company_name:l.user.company_name||"",birth_date:l.user.birth_date||"",state_id:l.user.state_id||"",city_id:l.user.city_id||"",password:"",password_confirmation:""}),a.value={}};return(m,s)=>(n(),i(x,null,[z(F(T),{title:"Profile"}),z(R,{breadcrumbs:E},{default:j(()=>[e("div",G,[e("div",H,[e("div",J,[s[28]||(s[28]=e("div",{class:"card-header py-2"},[e("h6",{class:"card-title mb-0",style:{"font-size":"1rem","font-weight":"600"}},"Profile Information")],-1)),e("div",K,[e("form",{onSubmit:I(P,["prevent"])},[e("div",Q,[e("div",W,[e("div",X,[s[13]||(s[13]=e("label",{for:"name",class:"form-label mb-1",style:{"font-size":"14px"}},"Full Name",-1)),c(e("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=o=>t.name=o),type:"text",class:u(["form-control form-control-sm",{"is-invalid":a.value.name}]),placeholder:"Enter full name",required:""},null,2),[[p,t.name]]),a.value.name?(n(),i("div",Y,r(a.value.name[0]),1)):d("",!0)])]),e("div",Z,[e("div",ee,[s[14]||(s[14]=e("label",{for:"username",class:"form-label mb-1",style:{"font-size":"14px"}},"Username",-1)),c(e("input",{id:"username","onUpdate:modelValue":s[1]||(s[1]=o=>t.username=o),type:"text",class:u(["form-control form-control-sm",{"is-invalid":a.value.username}]),placeholder:"Enter username",required:""},null,2),[[p,t.username]]),a.value.username?(n(),i("div",se,r(a.value.username[0]),1)):d("",!0)])]),e("div",te,[e("div",ae,[s[15]||(s[15]=e("label",{for:"first_name",class:"form-label mb-1",style:{"font-size":"14px"}},"First Name",-1)),c(e("input",{id:"first_name","onUpdate:modelValue":s[2]||(s[2]=o=>t.first_name=o),type:"text",class:u(["form-control form-control-sm",{"is-invalid":a.value.first_name}]),placeholder:"Enter first name",required:""},null,2),[[p,t.first_name]]),a.value.first_name?(n(),i("div",oe,r(a.value.first_name[0]),1)):d("",!0)])]),e("div",le,[e("div",ie,[s[16]||(s[16]=e("label",{for:"last_name",class:"form-label mb-1",style:{"font-size":"14px"}},"Last Name",-1)),c(e("input",{id:"last_name","onUpdate:modelValue":s[3]||(s[3]=o=>t.last_name=o),type:"text",class:u(["form-control form-control-sm",{"is-invalid":a.value.last_name}]),placeholder:"Enter last name",required:""},null,2),[[p,t.last_name]]),a.value.last_name?(n(),i("div",ne,r(a.value.last_name[0]),1)):d("",!0)])]),e("div",re,[e("div",de,[s[17]||(s[17]=e("label",{for:"middle_name",class:"form-label mb-1",style:{"font-size":"14px"}},"Middle Name",-1)),c(e("input",{id:"middle_name","onUpdate:modelValue":s[4]||(s[4]=o=>t.middle_name=o),type:"text",class:u(["form-control form-control-sm",{"is-invalid":a.value.middle_name}]),placeholder:"Enter middle name (optional)"},null,2),[[p,t.middle_name]]),a.value.middle_name?(n(),i("div",me,r(a.value.middle_name[0]),1)):d("",!0)])]),e("div",ue,[e("div",ce,[s[18]||(s[18]=e("label",{for:"email",class:"form-label mb-1",style:{"font-size":"14px"}},"Email",-1)),c(e("input",{id:"email","onUpdate:modelValue":s[5]||(s[5]=o=>t.email=o),type:"email",class:u(["form-control form-control-sm",{"is-invalid":a.value.email}]),placeholder:"Enter email",required:""},null,2),[[p,t.email]]),a.value.email?(n(),i("div",pe,r(a.value.email[0]),1)):d("",!0)])]),e("div",fe,[e("div",_e,[s[19]||(s[19]=e("label",{for:"mobile",class:"form-label mb-1",style:{"font-size":"14px"}},"Mobile",-1)),c(e("input",{id:"mobile","onUpdate:modelValue":s[6]||(s[6]=o=>t.mobile=o),type:"text",class:u(["form-control form-control-sm",{"is-invalid":a.value.mobile}]),placeholder:"Enter mobile number (optional)"},null,2),[[p,t.mobile]]),a.value.mobile?(n(),i("div",ve,r(a.value.mobile[0]),1)):d("",!0)])]),e("div",be,[e("div",ye,[s[20]||(s[20]=e("label",{for:"company_name",class:"form-label mb-1",style:{"font-size":"14px"}},"Company Name",-1)),c(e("input",{id:"company_name","onUpdate:modelValue":s[7]||(s[7]=o=>t.company_name=o),type:"text",class:u(["form-control form-control-sm",{"is-invalid":a.value.company_name}]),placeholder:"Enter company name (optional)"},null,2),[[p,t.company_name]]),a.value.company_name?(n(),i("div",xe,r(a.value.company_name[0]),1)):d("",!0)])]),e("div",he,[e("div",we,[s[21]||(s[21]=e("label",{for:"birth_date",class:"form-label mb-1",style:{"font-size":"14px"}},"Birth Date",-1)),c(e("input",{id:"birth_date","onUpdate:modelValue":s[8]||(s[8]=o=>w.value=o),type:"date",class:u(["form-control form-control-sm",{"is-invalid":a.value.birth_date}])},null,2),[[p,w.value]]),a.value.birth_date?(n(),i("div",ge,r(a.value.birth_date[0]),1)):d("",!0)])]),e("div",ke,[e("div",ze,[s[23]||(s[23]=e("label",{for:"state_id",class:"form-label mb-1",style:{"font-size":"14px"}},"State",-1)),c(e("select",{id:"state_id","onUpdate:modelValue":s[9]||(s[9]=o=>t.state_id=o),class:u(["form-control form-control-sm",{"is-invalid":a.value.state_id}]),onChange:N},[s[22]||(s[22]=e("option",{value:""},"Select a state",-1)),(n(!0),i(x,null,U(h.states,o=>(n(),i("option",{key:o.id,value:o.id},r(o.name)+" ("+r(o.code)+") ",9,Ue))),128))],34),[[V,t.state_id]]),a.value.state_id?(n(),i("div",Ve,r(a.value.state_id[0]),1)):d("",!0)])]),e("div",Ce,[e("div",Ee,[s[25]||(s[25]=e("label",{for:"city_id",class:"form-label mb-1",style:{"font-size":"14px"}},"City",-1)),c(e("select",{id:"city_id","onUpdate:modelValue":s[10]||(s[10]=o=>t.city_id=o),class:u(["form-control form-control-sm",{"is-invalid":a.value.city_id}]),disabled:!t.state_id||y.value},[s[24]||(s[24]=e("option",{value:""},"Select a city",-1)),(n(!0),i(x,null,U(b.value,o=>(n(),i("option",{key:o.id,value:o.id},r(o.name),9,Pe))),128))],10,Ne),[[V,t.city_id]]),y.value?(n(),i("div",Se,"Loading cities...")):d("",!0),a.value.city_id?(n(),i("div",qe,r(a.value.city_id[0]),1)):d("",!0)])]),e("div",Me,[e("div",Be,[s[26]||(s[26]=e("label",{for:"password",class:"form-label mb-1",style:{"font-size":"14px"}},"New Password",-1)),c(e("input",{id:"password","onUpdate:modelValue":s[11]||(s[11]=o=>t.password=o),type:"password",class:u(["form-control form-control-sm",{"is-invalid":a.value.password}]),placeholder:"Enter new password (optional)"},null,2),[[p,t.password]]),a.value.password?(n(),i("div",De,r(a.value.password[0]),1)):d("",!0)])]),e("div",Fe,[e("div",Te,[s[27]||(s[27]=e("label",{for:"password_confirmation",class:"form-label mb-1",style:{"font-size":"14px"}},"Confirm New Password",-1)),c(e("input",{id:"password_confirmation","onUpdate:modelValue":s[12]||(s[12]=o=>t.password_confirmation=o),type:"password",class:u(["form-control form-control-sm",{"is-invalid":a.value.password_confirmation}]),placeholder:"Confirm new password"},null,2),[[p,t.password_confirmation]]),a.value.password_confirmation?(n(),i("div",je,r(a.value.password_confirmation[0]),1)):d("",!0)])])]),e("div",Ie,[e("button",{type:"button",class:"btn btn-warning",onClick:S}," Reset "),e("button",{type:"submit",class:"btn btn-primary",disabled:_.value},[_.value?(n(),i("span",$e)):d("",!0),_.value?(n(),i("span",Oe,"Updating...")):(n(),i("span",Re,"Update Profile"))],8,Le)])],32)])])])]),f.value.show?(n(),i("div",{key:0,class:u(["toast-notification",f.value.type==="success"?"toast-success":"toast-error"]),style:{position:"fixed",top:"20px",right:"20px","z-index":"9999","min-width":"300px",padding:"12px 16px","border-radius":"8px",color:"white","font-weight":"500","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"}},[e("div",Ae,[e("span",Ge,r(f.value.type==="success"?"✅":"❌"),1),e("span",null,r(f.value.message),1)])],2)):d("",!0)]),_:1})],64))}}),Xe=O(He,[["__scopeId","data-v-08c49a40"]]);export{Xe as default};
