import{d as z,f as d,r as A,c as m,a as _,u as T,h as E,w,b as s,i as b,q as x,e as p,t as f,n as D,F,s as h,I as v,_ as I}from"./app-0JMNLgL9.js";import{_ as N}from"./AppLayout.vue_vue_type_script_setup_true_lang-B_cPmPuj.js";import{_ as V}from"./UserForm.vue_vue_type_script_setup_true_lang-DfQVg0yt.js";import{_ as M}from"./UserTable.vue_vue_type_script_setup_true_lang-BYEZ50_K.js";import{d as q}from"./index-BcgMG_W3.js";import"./index-CMWG4mbA.js";const L={class:"row"},Y={class:"col-12"},P={key:0,class:"modal fade show d-block",tabindex:"-1",role:"dialog","aria-labelledby":"userModalLabel","aria-hidden":"false",style:{"background-color":"rgba(0,0,0,0.5)"}},j={class:"modal-dialog modal-lg modal-dialog-centered",role:"document"},G={class:"modal-content"},H={class:"modal-header py-2 px-3"},J={class:"modal-title mb-0",id:"userModalLabel",style:{"font-size":"16px","font-weight":"600"}},K={class:"modal-body py-3 px-3"},O={class:"modal-footer py-2 px-3"},Q=["disabled"],R={key:0,class:"spinner-border spinner-border-sm me-1"},W={class:"d-flex align-items-center"},X={class:"me-2",style:{"font-size":"18px"}},Z=z({__name:"Users",props:{users:{},states:{}},setup(y){const C=[{title:"Dashboard",href:q().url},{title:"Users",href:"/users"}],c=d(!1),r=d(null),u=d(!1),i=d({}),n=d({show:!1,message:"",type:"success"}),e=A({name:"",username:"",first_name:"",middle_name:"",last_name:"",mobile:"",email:"",company_name:"",birth_date:"",state_id:"",city_id:"",is_active:!0,password:""}),l=()=>{e.name="",e.username="",e.first_name="",e.middle_name="",e.last_name="",e.mobile="",e.email="",e.company_name="",e.birth_date="",e.state_id="",e.city_id="",e.is_active=!0,e.password="",i.value={},r.value=null,c.value=!1},o=(t,a="success")=>{n.value={show:!0,message:t,type:a},setTimeout(()=>{n.value.show=!1},3e3)},U=t=>{r.value=t,e.name=t.name,e.username=t.username,e.first_name=t.first_name,e.middle_name=t.middle_name||"",e.last_name=t.last_name,e.mobile=t.mobile||"",e.email=t.email,e.company_name=t.company_name||"",e.birth_date=t.birth_date||"",e.state_id=t.state_id?.toString()||"",e.city_id=t.city_id?.toString()||"",e.is_active=t.is_active,e.password="",i.value={},c.value=!0},k=()=>{l(),c.value=!0},g=async()=>{u.value=!0,i.value={};try{const t={...e,state_id:e.state_id?parseInt(e.state_id):null,city_id:e.city_id?parseInt(e.city_id):null};r.value?(t.password||delete t.password,await h.put(`/users/${r.value.id}`,t),o("User updated successfully!")):(await h.post("/users",t),o("User created successfully!")),l(),v.reload()}catch(t){t.response?.status===422?(i.value=t.response.data.errors,o("Please fix the validation errors.","error")):(console.error("Error saving user:",t),o("An error occurred while saving the user.","error"))}finally{u.value=!1}},B=async t=>{if((await window.Swal.fire({title:"Are you sure?",text:`You are about to delete the user "${t.name}". This action cannot be undone!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{await h.delete(`/users/${t.id}`),o("User deleted successfully!"),v.reload()}catch($){console.error("Error deleting user:",$),o("An error occurred while deleting the user.","error")}},S=async t=>{try{await h.patch(`/users/${t.id}/toggle-active`),o(`User ${t.is_active?"deactivated":"activated"} successfully!`),v.reload()}catch(a){console.error("Error toggling user status:",a),o("An error occurred while updating user status.","error")}};return(t,a)=>(p(),m(F,null,[_(T(E),{title:"Users Management"}),_(N,{breadcrumbs:C},{default:w(()=>[s("div",L,[s("div",Y,[_(M,{users:y.users,onEdit:U,onDelete:B,onToggleActive:S},{"header-action":w(()=>[s("button",{onClick:k,class:"btn btn-primary btn-sm btn-default btn-squared text-capitalize lh-normal px-3 py-2"},[...a[0]||(a[0]=[s("span",{"data-feather":"plus",class:"me-1"},null,-1),x(" Add User ",-1)])])]),_:1},8,["users"]),c.value?(p(),m("div",P,[s("div",j,[s("div",G,[s("div",H,[s("h5",J,f(r.value?"Edit User":"Create User"),1),s("button",{type:"button",class:"btn-close",onClick:l,"aria-label":"Close"},[...a[1]||(a[1]=[s("span",{"aria-hidden":"true"},"×",-1)])])]),s("div",K,[_(V,{form:e,states:y.states,"editing-user":r.value,errors:i.value,onSubmit:g,onCancel:l},null,8,["form","states","editing-user","errors"])]),s("div",O,[s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:l,style:{"font-size":"13px"}}," Cancel "),s("button",{type:"button",class:"btn btn-primary btn-sm",onClick:g,disabled:u.value,style:{"font-size":"13px"}},[u.value?(p(),m("span",R)):b("",!0),x(" "+f(r.value?"Update User":"Create User"),1)],8,Q)])])])])):b("",!0)])]),n.value.show?(p(),m("div",{key:0,class:D(["toast-notification",n.value.type==="success"?"toast-success":"toast-error"]),style:{position:"fixed",top:"20px",right:"20px","z-index":"9999","min-width":"300px",padding:"12px 16px","border-radius":"8px",color:"white","font-weight":"500","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"}},[s("div",W,[s("span",X,f(n.value.type==="success"?"✅":"❌"),1),s("span",null,f(n.value.message),1)])],2)):b("",!0)]),_:1})],64))}}),ie=I(Z,[["__scopeId","data-v-75fa940a"]]);export{ie as default};
