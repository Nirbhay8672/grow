import{d as B,r as c,f as S,c as v,a as n,u as T,h as $,w as m,b as s,i as A,A as k,e as y,m as E,t as h,F,s as _,x,_ as N}from"./app-EEW5rfl7.js";import{_ as V}from"./AppLayout.vue_vue_type_script_setup_true_lang-CNQNEmhQ.js";import{M as D}from"./Modal-DgqnacDg.js";import{d as I}from"./index-BcgMG_W3.js";import{_ as M}from"./LocalityForm.vue_vue_type_script_setup_true_lang-BSFKYHTK.js";import{_ as Y}from"./LocalityTable.vue_vue_type_script_setup_true_lang-DoCOWg0E.js";import"./index-CMWG4mbA.js";const q={class:"row"},P={class:"col-12"},R={class:"d-flex align-items-center"},U={class:"me-2",style:{"font-size":"18px"}},j=B({__name:"Localities",props:{localities:{},states:{}},setup(w){const f=w,b=[{title:"Dashboard",href:I().url},{title:"Localities",href:"/localities"}],d=c(!1),a=c(null),u=c(!1),l=c({}),o=c({show:!1,message:"",type:"success"}),t=S({name:"",zip_code:"",state_id:"",city_id:"",is_active:!0}),p=()=>{t.name="",t.zip_code="",t.state_id="",t.city_id="",t.is_active=!0,l.value={},a.value=null,d.value=!1},g=()=>{p(),d.value=!0},C=e=>{a.value=e,t.name=e.name,t.zip_code=e.zip_code,t.state_id=e.state_id.toString(),t.city_id=e.city_id.toString(),t.is_active=e.is_active,l.value={},d.value=!0},i=(e,r="success")=>{o.value={show:!0,message:e,type:r},setTimeout(()=>{o.value.show=!1},3e3)},L=async()=>{u.value=!0,l.value={};try{const e={name:t.name,zip_code:t.zip_code,state_id:parseInt(t.state_id),city_id:parseInt(t.city_id),is_active:t.is_active};a.value?(await _.put(`/localities/${a.value.id}`,e),i("Locality updated successfully!")):(await _.post("/localities",e),i("Locality created successfully!")),p(),x.reload()}catch(e){e.response?.status===422?(l.value=e.response.data.errors,i("Please fix the validation errors.","error")):i("An error occurred while saving the locality.","error")}finally{u.value=!1}},z=async e=>{if((await window.Swal.fire({title:"Are you sure?",text:`You are about to delete the locality "${e.name}". This action cannot be undone!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0})).isConfirmed)try{await _.delete(`/localities/${e.id}`),i("Locality deleted successfully!"),x.reload()}catch{i("An error occurred while deleting the locality.","error")}};return(e,r)=>(y(),v(F,null,[n(T($),{title:"Localities Management"}),n(V,{breadcrumbs:b},{default:m(()=>[s("div",q,[s("div",P,[n(Y,{localities:f.localities,onEdit:C,onDelete:z},{"header-action":m(()=>[s("button",{onClick:g,class:"btn btn-primary btn-sm btn-default btn-squared text-capitalize lh-normal px-3 py-2"},[...r[0]||(r[0]=[s("span",{"data-feather":"plus",class:"me-1"},null,-1),k(" Add Locality ",-1)])])]),_:1},8,["localities"]),n(D,{show:d.value,title:a.value?"Edit Locality":"Create Locality",loading:u.value,"submit-label":a.value?"Update Locality":"Create Locality",size:"sm",onClose:p,onSubmit:L},{default:m(()=>[n(M,{form:t,states:f.states,"editing-locality":a.value,errors:l.value},null,8,["form","states","editing-locality","errors"])]),_:1},8,["show","title","loading","submit-label"])])]),o.value.show?(y(),v("div",{key:0,class:E(["toast-notification",o.value.type==="success"?"toast-success":"toast-error"]),style:{position:"fixed",top:"20px",right:"20px","z-index":"9999","min-width":"300px",padding:"12px 16px","border-radius":"8px",color:"white","font-weight":"500","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"}},[s("div",R,[s("span",U,h(o.value.type==="success"?"✅":"❌"),1),s("span",null,h(o.value.message),1)])],2)):A("",!0)]),_:1})],64))}}),ee=N(j,[["__scopeId","data-v-dd51a698"]]);export{ee as default};
